<!DOCTYPE html>
<html lang="ko" dir=>

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Description">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Tensorflow" />
<meta property="og:description" content="Description" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://prokoptasis.github.io/docs/documents/deeplearning/tensorflow/" />

<title>Tensorflow | Prokoptasis</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.001ba32d1ef4d2469d055e28d66fd96b16bfeddee698f1e2729af3a54ed86b8b.css" integrity="sha256-ABujLR700kadBV4o1m/Zaxa/7d7mmPHicprzpU7Ya4s=">
<script defer src="/ko.search.min.2ffaed2d750b0b6f623956c311f997ff436af79cdd2063f714188d5ba3383f37.js" integrity="sha256-L/rtLXULC29iOVbDEfmX/0Nq95zdIGP3FBiNW6M4Pzc="></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-176412981-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<link rel="alternate" type="application/rss+xml" href="http://prokoptasis.github.io/docs/documents/deeplearning/tensorflow/index.xml" title="Prokoptasis" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
 
</head>

<body dir=>
    <input type="checkbox" class="hidden toggle" id="menu-control" />
    <input type="checkbox" class="hidden toggle" id="toc-control" />
    <main class="container flex">
        <aside class="book-menu">
             <nav>
<h2 class="book-brand" style="text-align: center;">
    <a href="/"><span>Prokoptasis</span>
  </a>
</h2>
<hr>

<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





 


  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Documents</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bc65bd57d9bab5039e9a79b5ae591c72" class="toggle"  />
    <label for="section-bc65bd57d9bab5039e9a79b5ae591c72" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/projects/" class="">Projects</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/projects/hugogirl/" class="">hU-Go-Girl</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-53481227639f164d3f7ead2411c43315" class="toggle"  />
    <label for="section-53481227639f164d3f7ead2411c43315" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/frontend/" class="">Front End</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/frontend/markdown/" class="">Markdown</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7cff03fc158d9929dd882d45e5e83f84" class="toggle"  />
    <label for="section-7cff03fc158d9929dd882d45e5e83f84" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/backend/" class="">Back End</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0480d4c0a3a48973d66dda9e8e9d50da" class="toggle"  />
    <label for="section-0480d4c0a3a48973d66dda9e8e9d50da" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/backend/rust/" class="">Rust</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/rust/rust01/" class="">Rust Basic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/rust/rust02/" class="">Rust Basic 02</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0d89b8a13399f7331f6db819807b653c" class="toggle"  />
    <label for="section-0d89b8a13399f7331f6db819807b653c" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/backend/go/" class="">Go</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/go/go01/" class="">GO Basic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/go/go02/" class="">GO Advanced</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/go/go03/" class="">GO DB 연결</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-47bd3d4bf94d414a097efcbbc9ad3f79" class="toggle"  />
    <label for="section-47bd3d4bf94d414a097efcbbc9ad3f79" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/backend/sql/" class="">SQL</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/sql/sql01/" class="">SQL Basic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/backend/sql/sql02/" class="">SQL Advanced</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-08315e14cb91d15111d683212f692de5" class="toggle" checked />
    <label for="section-08315e14cb91d15111d683212f692de5" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/deeplearning/" class="">Deep Learning</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/deeplearning/machinelearning/" class="">Machine Learning</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/deeplearning/tensorflow/" class=" active">Tensorflow</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ae112940aeb03e8cb2e77b93d2c01134" class="toggle"  />
    <label for="section-ae112940aeb03e8cb2e77b93d2c01134" class="flex justify-between">
      <a href="http://prokoptasis.github.io/docs/documents/english/" class="">English</a>
      <span>▾</span>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/english/seulsam/" class="">Seulsam</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://prokoptasis.github.io/docs/documents/english/pickedup/" class="">Picked Up English</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>










 
<ul>
    
    <li>
        <a href="/posts/" >
        Blog
      </a>
    </li>
    
    <li>
        <a href="mailto:c.exigua@gmail.com" target="_blank" rel="noopener" >
        Gmail
      </a>
    </li>
    
    <li>
        <a href="https://github.com/prokoptasis/prokoptasis" target="_blank" rel="noopener" >
        Github
      </a>
    </li>
    
    <li>
        <a href="https://twitter.com/prokoptasis" target="_blank" rel="noopener" >
        Twitter
      </a>
    </li>
    
    <li>
        <a href="https://www.facebook.com/c.exigua/" target="_blank" rel="noopener" >
        Facebook
      </a>
    </li>
    
</ul>
<br>
<hr>
<div style="display: block; text-align: center;">
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="prokoptasis" data-color="#e9e9e9" data-emoji="" data-font="Arial" data-text="" data-outline-color="#000" data-font-color="#000"
        data-coffee-color="#6f4e37"></script>
</div>
  

</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>

 
            
        </aside>

        <div class="book-page">
            <header class="book-header">
                 <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Tensorflow</strong>

  <label for="toc-control">
    
  </label>
</div>
  
                
            </header>

            
<article class="markdown"><h2 id="tensor-flow">
  Tensor Flow
  <a class="anchor" href="#tensor-flow">#</a>
</h2>
<hr>
<p>텐저 플로우는 2015년 구글에서 공개한 머신러닝 라이브러리. 케라스는 딥러닝 라이브러리를 Backend로 하는 신경망 모델 구성 라이브러리. 구글은 쥬피터 노트북이라는 오픈 소스 웹 어플리케이션을 코랩이라는 서비스를 통해 제공하고 있음.</p>
<p><a href="https://www.tensorflow.org/?hl=ko" target="_blank" rel="noopener">Tensor Flow</a><br>
<a href="https://keras.io/" target="_blank" rel="noopener">Keras</a><br>
<a href="https://www.python.org/" target="_blank" rel="noopener">Python</a><br>
<a href="https://jupyter.org/" target="_blank" rel="noopener">Jupyter Notebook</a><br>
<a href="https://colab.research.google.com/notebooks/intro.ipynb" target="_blank" rel="noopener">Colab</a></p>
<p>이때 Tensor는 흘러다니는 데이터를 의미함.</p>


<script src="/mermaid.min.js"></script>

  <script>mermaid.initialize({
  "flowchart": {
    "useMaxWidth":true
  },
  "theme": "default"
}
)</script>




<p class="mermaid text-center">
graph LR
A((X:Tensor))-->|Edge|C((+:Node))-->|Edge|D((X+Y:Tensor))
B((Y:Tensor))-->|Edge|C

style A fill:#ffffff,stroke:#000000,stroke-width:1px
style B fill:#ffffff,stroke:#000000,stroke-width:1px
style C fill:#ffffff,stroke:#000000,stroke-width:1px
style D fill:#ffffff,stroke:#000000,stroke-width:1px
</p>

<h3 id="모두를-위한-딥러닝-시즌2">
  모두를 위한 딥러닝 시즌2
  <a class="anchor" href="#%eb%aa%a8%eb%91%90%eb%a5%bc-%ec%9c%84%ed%95%9c-%eb%94%a5%eb%9f%ac%eb%8b%9d-%ec%8b%9c%ec%a6%8c2">#</a>
</h3>
<p>아래는 <a href="https://www.youtube.com/playlist?list=PLQ28Nx3M4Jrguyuwg4xe9d9t2XE639e5C" target="_blank" rel="noopener">모두를 위한 딥러닝 시즌2</a>의 Tensorflow 2 Code를 분석한 내용임.</p>

<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>lab-02-1</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
       <div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># import library</span>
<span style="color:#f92672">import</span> tensorflow <span style="color:#f92672">as</span> tf
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># tensor flow version 확인</span>
<span style="color:#66d9ef">print</span>(tf<span style="color:#f92672">.</span>__version__)

<span style="color:#75715e"># X,Y 1,2,3 np array 선언 </span>
X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])

<span style="color:#75715e"># cost_func 정의 (Python형태)</span>
<span style="color:#75715e"># Weight, X, Y를 인자로 전달</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cost_func_py</span>(W, X, Y):
    <span style="color:#75715e"># c 를 0으로 초기화</span>
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#75715e"># X 만큼 Loop를 돌며 (W*X - Y) ^ 2 -&gt; C로 대입</span>
    <span style="color:#75715e"># C (오차 제곱근)을 X로 평균낸 값을 return</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(X)):
        c <span style="color:#f92672">+=</span> (W <span style="color:#f92672">*</span> X[i] <span style="color:#f92672">-</span> Y[i]) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">return</span> c <span style="color:#f92672">/</span> len(X)

<span style="color:#75715e"># cost_func 정의 (tensorflow형태)</span>
<span style="color:#75715e"># Weight, X, Y를 인자로 전달</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cost_func_tf</span>(W, X, Y):
  hypothesis <span style="color:#f92672">=</span> X <span style="color:#f92672">*</span> W
  <span style="color:#66d9ef">return</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

<span style="color:#75715e"># Weight를 -3부터 5까지 9개의 요소로 제공 </span>
W_values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">12</span>, num<span style="color:#f92672">=</span><span style="color:#ae81ff">23</span>)
cost_values <span style="color:#f92672">=</span> []

<span style="color:#75715e"># numpy.linspace (start,end,number)</span>
<span style="color:#75715e"># 제공된 Weight, X, Y로 Cost를 계산</span>
<span style="color:#66d9ef">for</span> feed_W <span style="color:#f92672">in</span> W_values:
    curr_cost_py <span style="color:#f92672">=</span> cost_func_py(feed_W, X, Y)    
    curr_cost_tf <span style="color:#f92672">=</span> cost_func_tf(feed_W, X, Y)
    cost_values<span style="color:#f92672">.</span>append(curr_cost_tf)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{:6.3f} | {:10.5f} | {:10.5f}&#34;</span><span style="color:#f92672">.</span>format(feed_W, curr_cost_py, curr_cost_tf))

<span style="color:#75715e"># matplot import</span>
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

<span style="color:#75715e"># figure size 지정</span>
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;figure.figsize&#34;</span>] <span style="color:#f92672">=</span> (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">6</span>)
plt<span style="color:#f92672">.</span>plot(W_values, cost_values, <span style="color:#e6db74">&#34;b&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Cost(W)&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;W&#39;</span>)
plt<span style="color:#f92672">.</span>show()

<span style="color:#75715e"># random 사용시 Seed 설정</span>
tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>set_seed(<span style="color:#ae81ff">0</span>)  <span style="color:#75715e"># for reproducibility</span>

x_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">2.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">4.</span>]
y_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">5.</span>, <span style="color:#ae81ff">7.</span>]

<span style="color:#75715e"># random.normal((배열),mean,stddev)</span>
W <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable(tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal((<span style="color:#ae81ff">1</span>,), <span style="color:#f92672">-</span><span style="color:#ae81ff">100.</span>, <span style="color:#ae81ff">100.</span>))

<span style="color:#75715e"># 300까지 for </span>
<span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">300</span>):
    <span style="color:#75715e"># 가설을 W*X로 정의</span>
    hypothesis <span style="color:#f92672">=</span> W <span style="color:#f92672">*</span> X
    <span style="color:#75715e"># TF의 Cost 함수 사용</span>
    cost <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

    <span style="color:#75715e"># Learning Rate 0.01</span>
    alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>

    <span style="color:#75715e"># 경사 하강법</span>
    gradient <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>multiply(tf<span style="color:#f92672">.</span>multiply(W, X) <span style="color:#f92672">-</span> Y, X))

    <span style="color:#75715e"># W - alpha * W&#39;</span>
    descent <span style="color:#f92672">=</span> W <span style="color:#f92672">-</span> tf<span style="color:#f92672">.</span>multiply(alpha, gradient)
    W<span style="color:#f92672">.</span>assign(descent)
    
    <span style="color:#75715e"># 10 step 마다 로그</span>
    <span style="color:#66d9ef">if</span> step <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{:5} | {:15.6f} | {:10.6f}&#39;</span><span style="color:#f92672">.</span>format( step, cost<span style="color:#f92672">.</span>numpy(), W<span style="color:#f92672">.</span>numpy()[<span style="color:#ae81ff">0</span>]) )

<span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">5.0</span> <span style="color:#f92672">*</span> W)
<span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">2.5</span> <span style="color:#f92672">*</span> W)		

x_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">2.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">4.</span>]
y_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">5.</span>, <span style="color:#ae81ff">7.</span>]

<span style="color:#75715e"># Weight 5부터 접근</span>
W <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable([<span style="color:#ae81ff">5.0</span>])

<span style="color:#75715e"># 300까지 for </span>
<span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">300</span>):
    <span style="color:#75715e"># 가설을 W*X로 정의</span>
    hypothesis <span style="color:#f92672">=</span> W <span style="color:#f92672">*</span> X
    <span style="color:#75715e"># TF의 Cost 함수 사용</span>
    cost <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

    <span style="color:#75715e"># Learning Rate 0.01</span>
    alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>

    <span style="color:#75715e"># 경사 하강법</span>
    gradient <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>multiply(tf<span style="color:#f92672">.</span>multiply(W, X) <span style="color:#f92672">-</span> Y, X))

    <span style="color:#75715e"># W - alpha * W&#39;</span>
    descent <span style="color:#f92672">=</span> W <span style="color:#f92672">-</span> tf<span style="color:#f92672">.</span>multiply(alpha, gradient)
    W<span style="color:#f92672">.</span>assign(descent)
    
    <span style="color:#75715e"># 10 step 마다 로그</span>
    <span style="color:#66d9ef">if</span> step <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{:5} | {:10.4f} | {:10.6f}&#39;</span><span style="color:#f92672">.</span>format(step, cost<span style="color:#f92672">.</span>numpy(), W<span style="color:#f92672">.</span>numpy()[<span style="color:#ae81ff">0</span>]))
</code></pre></div></div>
    </div>
  </label>
</div>


<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>lab-03-1</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
       <div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># import library</span>
<span style="color:#f92672">import</span> tensorflow <span style="color:#f92672">as</span> tf
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># tensor flow version 확인</span>
<span style="color:#66d9ef">print</span>(tf<span style="color:#f92672">.</span>__version__)

<span style="color:#75715e"># X,Y 1,2,3 np array 선언 </span>
X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])

<span style="color:#75715e"># cost_func 정의 (Python형태)</span>
<span style="color:#75715e"># Weight, X, Y를 인자로 전달</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cost_func_py</span>(W, X, Y):
    <span style="color:#75715e"># c 를 0으로 초기화</span>
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#75715e"># X 만큼 Loop를 돌며 (W*X - Y) ^ 2 -&gt; C로 대입</span>
    <span style="color:#75715e"># C (오차 제곱근)을 X로 평균낸 값을 return</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(X)):
        c <span style="color:#f92672">+=</span> (W <span style="color:#f92672">*</span> X[i] <span style="color:#f92672">-</span> Y[i]) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">return</span> c <span style="color:#f92672">/</span> len(X)

<span style="color:#75715e"># cost_func 정의 (tensorflow형태)</span>
<span style="color:#75715e"># Weight, X, Y를 인자로 전달</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cost_func_tf</span>(W, X, Y):
  hypothesis <span style="color:#f92672">=</span> X <span style="color:#f92672">*</span> W
  <span style="color:#66d9ef">return</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

<span style="color:#75715e"># Weight를 -3부터 5까지 9개의 요소로 제공 </span>
W_values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">12</span>, num<span style="color:#f92672">=</span><span style="color:#ae81ff">23</span>)
cost_values <span style="color:#f92672">=</span> []

<span style="color:#75715e"># numpy.linspace (start,end,number)</span>
<span style="color:#75715e"># 제공된 Weight, X, Y로 Cost를 계산</span>
<span style="color:#66d9ef">for</span> feed_W <span style="color:#f92672">in</span> W_values:
    curr_cost_py <span style="color:#f92672">=</span> cost_func_py(feed_W, X, Y)    
    curr_cost_tf <span style="color:#f92672">=</span> cost_func_tf(feed_W, X, Y)
    cost_values<span style="color:#f92672">.</span>append(curr_cost_tf)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;{:6.3f} | {:10.5f} | {:10.5f}&#34;</span><span style="color:#f92672">.</span>format(feed_W, curr_cost_py, curr_cost_tf))

<span style="color:#75715e"># matplot import</span>
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

<span style="color:#75715e"># figure size 지정</span>
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;figure.figsize&#34;</span>] <span style="color:#f92672">=</span> (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">6</span>)
plt<span style="color:#f92672">.</span>plot(W_values, cost_values, <span style="color:#e6db74">&#34;b&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Cost(W)&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;W&#39;</span>)
plt<span style="color:#f92672">.</span>show()

<span style="color:#75715e"># random 사용시 Seed 설정</span>
tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>set_seed(<span style="color:#ae81ff">0</span>)  <span style="color:#75715e"># for reproducibility</span>

x_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">2.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">4.</span>]
y_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">5.</span>, <span style="color:#ae81ff">7.</span>]

<span style="color:#75715e"># random.normal((배열),mean,stddev)</span>
W <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable(tf<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal((<span style="color:#ae81ff">1</span>,), <span style="color:#f92672">-</span><span style="color:#ae81ff">100.</span>, <span style="color:#ae81ff">100.</span>))

<span style="color:#75715e"># 300까지 for </span>
<span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">300</span>):
    <span style="color:#75715e"># 가설을 W*X로 정의</span>
    hypothesis <span style="color:#f92672">=</span> W <span style="color:#f92672">*</span> X
    <span style="color:#75715e"># TF의 Cost 함수 사용</span>
    cost <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

    <span style="color:#75715e"># Learning Rate 0.01</span>
    alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>

    <span style="color:#75715e"># 경사 하강법</span>
    gradient <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>multiply(tf<span style="color:#f92672">.</span>multiply(W, X) <span style="color:#f92672">-</span> Y, X))

    <span style="color:#75715e"># W - alpha * W&#39;</span>
    descent <span style="color:#f92672">=</span> W <span style="color:#f92672">-</span> tf<span style="color:#f92672">.</span>multiply(alpha, gradient)
    W<span style="color:#f92672">.</span>assign(descent)
    
    <span style="color:#75715e"># 10 step 마다 로그</span>
    <span style="color:#66d9ef">if</span> step <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{:5} | {:15.6f} | {:10.6f}&#39;</span><span style="color:#f92672">.</span>format( step, cost<span style="color:#f92672">.</span>numpy(), W<span style="color:#f92672">.</span>numpy()[<span style="color:#ae81ff">0</span>]) )

<span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">5.0</span> <span style="color:#f92672">*</span> W)
<span style="color:#66d9ef">print</span>(<span style="color:#ae81ff">2.5</span> <span style="color:#f92672">*</span> W)

x_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">2.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">4.</span>]
y_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.</span>, <span style="color:#ae81ff">3.</span>, <span style="color:#ae81ff">5.</span>, <span style="color:#ae81ff">7.</span>]

<span style="color:#75715e"># Weight 5부터 접근</span>
W <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>Variable([<span style="color:#ae81ff">5.0</span>])

<span style="color:#75715e"># 300까지 for </span>
<span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">300</span>):
    <span style="color:#75715e"># 가설을 W*X로 정의</span>
    hypothesis <span style="color:#f92672">=</span> W <span style="color:#f92672">*</span> X
    <span style="color:#75715e"># TF의 Cost 함수 사용</span>
    cost <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>square(hypothesis <span style="color:#f92672">-</span> Y))

    <span style="color:#75715e"># Learning Rate 0.01</span>
    alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.01</span>

    <span style="color:#75715e"># 경사 하강법</span>
    gradient <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>reduce_mean(tf<span style="color:#f92672">.</span>multiply(tf<span style="color:#f92672">.</span>multiply(W, X) <span style="color:#f92672">-</span> Y, X))

    <span style="color:#75715e"># W - alpha * W&#39;</span>
    descent <span style="color:#f92672">=</span> W <span style="color:#f92672">-</span> tf<span style="color:#f92672">.</span>multiply(alpha, gradient)
    W<span style="color:#f92672">.</span>assign(descent)
    
    <span style="color:#75715e"># 10 step 마다 로그</span>
    <span style="color:#66d9ef">if</span> step <span style="color:#f92672">%</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{:5} | {:10.4f} | {:10.6f}&#39;</span><span style="color:#f92672">.</span>format(step, cost<span style="color:#f92672">.</span>numpy(), W<span style="color:#f92672">.</span>numpy()[<span style="color:#ae81ff">0</span>]))
</code></pre></div></div>
    </div>
  </label>
</div>

<br>
</article>

            
            

            <footer class="book-footer">
                 <div class="flex flex-wrap justify-between">





</div>
 
                
                
            </footer>

             
<div class="book-comments">
<br>
<br>
<hr> </hr>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "prokoptasis" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div>
 
            

            <label for="menu-control" class="hidden book-menu-overlay"></label>
        </div>

        
    </main>

    
</body>

</html>

     